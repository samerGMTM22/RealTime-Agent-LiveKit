
> rest-express@1.0.0 dev
Starting MCP health monitor...ver/index.ts
6:39:32 AM [express] serving on port 5000
Browserslist: browsers data (caniuse-lite) is 8 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
6:39:38 AM [express] GET /api/agent-configs/active 304 in 62ms :: {"id":1,"userId":1,"name":"Voice A…
6:39:38 AM [express] GET /api/status 200 in 273ms :: {"livekit":"online","openai":"connected","mcp":…
6:39:41 AM [express] POST /api/livekit/rooms 201 in 629ms :: {"sid":"RM_XLdSwnT9GVwr","name":"voice_…
6:39:41 AM [express] GET /api/livekit/url 304 in 0ms :: {"url":"wss://test-project-eg4kodos.livekit.…
6:39:41 AM [express] POST /api/livekit/token 200 in 1ms :: {"token":"eyJhbGciOiJIUzI1NiJ9.eyJ2aWRlby…
6:39:42 AM [express] GET /api/conversations 200 in 6ms
Starting Python LiveKit agent for room: voice_agent_session_1749883180162_ab6v3bkvg
Python LiveKit agent started for room voice_agent_session_1749883180162_ab6v3bkvg
Agent stdout: {"message": "starting worker", "level": "INFO", "name": "livekit.agents", "version": "1.0.23", "rtc-version": "1.0.8", "timestamp": "2025-06-14T06:39:44.066276+00:00"}

Agent stdout: {"message": "preloading plugins", "level": "INFO", "name": "livekit.agents", "packages": ["livekit.plugins.openai", "livekit.plugins.silero"], "timestamp": "2025-06-14T06:39:44.066412+00:00"}

Agent stdout: {"message": "initializing process", "level": "INFO", "name": "livekit.agents", "pid": 18064, "timestamp": "2025-06-14T06:39:45.637644+00:00"}

Agent stdout: {"message": "initializing process", "level": "INFO", "name": "livekit.agents", "pid": 18066, "timestamp": "2025-06-14T06:39:45.642055+00:00"}

Agent stdout: {"message": "initializing process", "level": "INFO", "name": "livekit.agents", "pid": 18068, "timestamp": "2025-06-14T06:39:45.650553+00:00"}

Agent stdout: {"message": "initializing process", "level": "INFO", "name": "livekit.agents", "pid": 18070, "timestamp": "2025-06-14T06:39:45.650972+00:00"}

Agent stdout: {"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 18068, "elapsed_time": 0.1, "timestamp": "2025-06-14T06:39:45.747680+00:00"}

Agent stdout: {"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 18070, "elapsed_time": 0.1, "timestamp": "2025-06-14T06:39:45.754335+00:00"}

Agent stdout: {"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 18066, "elapsed_time": 0.12, "timestamp": "2025-06-14T06:39:45.757855+00:00"}

Agent stdout: {"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 18064, "elapsed_time": 0.12, "timestamp": "2025-06-14T06:39:45.761736+00:00"}

Agent stdout: {"message": "see tracing information at http://localhost:8081/debug", "level": "INFO", "name": "livekit.agents", "timestamp": "2025-06-14T06:39:45.762339+00:00"}

Agent stdout: {"message": "registered worker", "level": "INFO", "name": "livekit.agents", "id": "AW_vVupqyGtdZEH", "url": "wss://test-project-eg4kodos.livekit.cloud", "region": "US West", "protocol": 16, "timestamp": "2025-06-14T06:39:45.918550+00:00"}

Agent stdout: {"message": "received job request", "level": "INFO", "name": "livekit.agents", "job_id": "AJ_aFoGidQPiBxH", "dispatch_id": "", "room_name": "voice_agent_session_1749883180162_ab6v3bkvg", "agent_name": "", "resuming": false, "timestamp": "2025-06-14T06:39:45.970498+00:00"}

Agent stdout: {"message": "Agent started for room: voice_agent_session_1749883180162_ab6v3bkvg", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.006817+00:00"}

Agent stdout: {"message": "initializing process", "level": "INFO", "name": "livekit.agents", "pid": 18091, "timestamp": "2025-06-14T06:39:46.100333+00:00"}

Agent stdout: {"message": "process initialized", "level": "INFO", "name": "livekit.agents", "pid": 18091, "elapsed_time": 0.08, "timestamp": "2025-06-14T06:39:46.176168+00:00"}

Agent stdout: {"message": "Participant joined: user", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.385152+00:00"}

6:39:46 AM [express] GET /api/agent-configs/1 200 in 58ms :: {"id":1,"userId":1,"name":"Voice Assist…
Agent stdout: {"message": "Fetched config from database: Voice Assistant", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.447786+00:00"}
{"message": "Using agent config: Voice Assistant", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.447941+00:00"}
{"message": "System prompt: You are a professional customer service agent. Your role is to assist customers with their inquiries...", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.447985+00:00"}
{"message": "Voice: echo, Temperature: 1.02", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.448037+00:00"}

Agent stdout: {"message": "Initializing MCP integration...", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.448078+00:00"}

6:39:46 AM [express] GET /api/mcp/servers 200 in 59ms :: [{"id":11,"userId":1,"name":"Zapier send dr…
Agent stdout: {"message": "MCP server Zapier send draft email marked as available", "level": "INFO", "name": "mcp_integration.simple_client", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.510654+00:00"}

Agent stdout: {"message": "Connected to MCP server: Zapier send draft email", "level": "INFO", "name": "mcp_integration.simple_client", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.510740+00:00"}

Agent stdout: {"message": "MCP server internet access marked as available", "level": "INFO", "name": "mcp_integration.simple_client", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.510780+00:00"}

Agent stdout: {"message": "Connected to MCP server: internet access", "level": "INFO", "name": "mcp_integration.simple_client", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.510816+00:00"}

Agent stdout: {"message": "Initialized 2 MCP servers", "level": "INFO", "name": "mcp_integration.simple_client", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.510846+00:00"}

Agent stdout: {"message": "Connected to 0 MCP servers", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.510967+00:00"}

Agent stdout: {"message": "Attempting OpenAI Realtime API", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.511009+00:00"}
{"message": "Assistant created with module-level function tools", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.511248+00:00"}

Agent stdout: {"message": "Error in _update_activity_task\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py\", line 16, in async_fn_logs\n    return await fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_session.py\", line 591, in _update_activity_task\n    await self._activity.start()\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_activity.py\", line 347, in start\n    await self._rt_session.update_tools(self.tools)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/plugins/openai/realtime/realtime_model.py\", line 878, in update_tools\n    self._tools = llm.ToolContext(retained_tools)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 219, in __init__\n    self.update_tools(tools)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 247, in update_tools\n    raise ValueError(f\"duplicate function name: {info.name}\")\nValueError: duplicate function name: search_web", "level": "ERROR", "name": "livekit.agents", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.533619+00:00"}

Agent stdout: {"message": "Realtime API failed: duplicate function name: search_web", "level": "ERROR", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.535312+00:00"}
{"message": "Falling back to STT-LLM-TTS pipeline", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.535372+00:00"}

Agent stdout: {"message": "pre-connect audio handler for lk.agent.pre-connect-audio-buffer already registered, ignoring", "level": "WARNING", "name": "livekit.agents", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.643094+00:00"}

Agent stdout: {"message": "text stream handler for topic 'lk.chat' already set, ignoring", "level": "WARNING", "name": "livekit.agents", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.643170+00:00"}

Agent stdout: {"message": "STT-LLM-TTS pipeline started successfully", "level": "INFO", "name": "voice-agent", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:46.645677+00:00"}

Agent stdout: {"message": "Error in _pipeline_reply_task\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py\", line 16, in async_fn_logs\n    return await fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_activity.py\", line 1118, in _pipeline_reply_task\n    tool_ctx = llm.ToolContext(tools)\n               ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 219, in __init__\n    self.update_tools(tools)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 247, in update_tools\n    raise ValueError(f\"duplicate function name: {info.name}\")\nValueError: duplicate function name: search_web", "level": "ERROR", "name": "livekit.agents", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:49.255224+00:00"}

Agent stdout: {"message": "Task exception was never retrieved\nfuture: <Task finished name='AgentActivity.pipeline_reply' coro=<AgentActivity._pipeline_reply_task() done, defined at /home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py:13> exception=ValueError('duplicate function name: search_web')>\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py\", line 16, in async_fn_logs\n    return await fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_activity.py\", line 1118, in _pipeline_reply_task\n    tool_ctx = llm.ToolContext(tools)\n               ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 219, in __init__\n    self.update_tools(tools)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 247, in update_tools\n    raise ValueError(f\"duplicate function name: {info.name}\")\nValueError: duplicate function name: search_web", "level": "ERROR", "name": "asyncio", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:49.256513+00:00"}

Agent stdout: {"message": "Error in _pipeline_reply_task\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py\", line 16, in async_fn_logs\n    return await fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_activity.py\", line 1118, in _pipeline_reply_task\n    tool_ctx = llm.ToolContext(tools)\n               ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 219, in __init__\n    self.update_tools(tools)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 247, in update_tools\n    raise ValueError(f\"duplicate function name: {info.name}\")\nValueError: duplicate function name: search_web", "level": "ERROR", "name": "livekit.agents", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:55.130820+00:00"}

Agent stdout: {"message": "Task exception was never retrieved\nfuture: <Task finished name='AgentActivity.pipeline_reply' coro=<AgentActivity._pipeline_reply_task() done, defined at /home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py:13> exception=ValueError('duplicate function name: search_web')>\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/utils/log.py\", line 16, in async_fn_logs\n    return await fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/voice/agent_activity.py\", line 1118, in _pipeline_reply_task\n    tool_ctx = llm.ToolContext(tools)\n               ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 219, in __init__\n    self.update_tools(tools)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/livekit/agents/llm/tool_context.py\", line 247, in update_tools\n    raise ValueError(f\"duplicate function name: {info.name}\")\nValueError: duplicate function name: search_web", "level": "ERROR", "name": "asyncio", "pid": 18068, "job_id": "AJ_aFoGidQPiBxH", "timestamp": "2025-06-14T06:39:55.131446+00:00"}

6:40:08 AM [express] GET /api/status 200 in 266ms :: {"livekit":"online","openai":"connected","mcp":…